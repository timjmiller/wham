<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Specify configuration for environmental covariates, effects on the population, and parameter values — set_ecov • wham</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Specify configuration for environmental covariates, effects on the population, and parameter values — set_ecov"><meta property="og:description" content="Specify configuration for environmental covariates, effects on the population, and parameter values"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wham</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li>
      <a href="../articles/ex01_basics.html">Ex 1: The basics</a>
    </li>
    <li>
      <a href="../articles/ex02_CPI_recruitment.html">Ex 2: Recruitment linked to an environmental covariate (Cold Pool Index)</a>
    </li>
    <li>
      <a href="../articles/ex03_projections.html">Ex 3: Projecting / forecasting random effects</a>
    </li>
    <li>
      <a href="../articles/ex4_selectivity.html">Ex 4: Selectivity with time- and age-varying random effects</a>
    </li>
    <li>
      <a href="../articles/ex05_GSI_M.html">Ex 5: Time-varying natural mortality linked to the Gulf Stream Index</a>
    </li>
    <li>
      <a href="../articles/ex06_NAA.html">Ex 6: Numbers-at-age / survival deviations as random effects</a>
    </li>
    <li>
      <a href="../articles/ex07_debug.html">Ex 7: Debugging WHAM models</a>
    </li>
    <li>
      <a href="../articles/ex08_compare.html">Ex 8: Compare ASAP and WHAM model results</a>
    </li>
    <li>
      <a href="../articles/ex09_retro_pred.html">Ex 9: Retrospective predictions</a>
    </li>
    <li>
      <a href="../articles/ex10_simulation.html">Ex 10: Simulations</a>
    </li>
    <li>
      <a href="../articles/ex11_catchability.html">Ex 11: Catchability configurations</a>
    </li>
    <li>
      <a href="../articles/ex12_multistock.html">Ex 12: Multiple stocks, regions</a>
    </li>
    <li>
      <a href="../articles/ex13_no_ASAP.html">Ex 13: WHAM without ASAP</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/timjmiller/wham/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    Source code
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-bullhorn fa-lg"></span>
     
    News
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/timjmiller/wham/issues/" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
<li>
  <a href="https://www.fisheries.noaa.gov/contact/timothy-miller-phd" class="external-link">
    <span class="fas fa-paper-plane fa-lg"></span>
     
    Contact
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Specify configuration for environmental covariates, effects on the population, and parameter values</h1>
    <small class="dont-index">Source: <a href="https://github.com/timjmiller/wham/blob/HEAD/R/set_ecov.R" class="external-link"><code>R/set_ecov.R</code></a></small>
    <div class="hidden name"><code>set_ecov.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Specify configuration for environmental covariates, effects on the population, and parameter values</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">set_ecov</span><span class="op">(</span><span class="va">input</span>, <span class="va">ecov</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input</dt>
<dd><p>list containing data, parameters, map, and random elements (output from <code><a href="prepare_wham_input.html">wham::prepare_wham_input</a></code>)</p></dd>


<dt>ecov</dt>
<dd><p>(optional) named list of environmental covariate data and parameters (see details)</p>
<p><code>ecov</code> specifies any environmental covariate data and model as well as the effect on the population. Environmental covariate data need not span
the same years as the fisheries data. It can be <code>NULL</code> if no environmental data are to be fit.
Otherwise, it must be a named list with the following components:</p><dl><dt>$label</dt>
<dd><p>Name(s) of the environmental covariate(s). Used in printing.</p></dd>

    <dt>$mean</dt>
<dd><p>Mean observations (matrix). number of years x number of covariates. Missing values = NA.</p></dd>

    <dt>$logsigma</dt>
<dd><p>Configure observation standard errors. Options:</p><dl><dt>Matrix of \(log\) standard errors with same dimensions as <code>$mean</code></dt>
<dd><p>Specified values for each time step</p></dd>

        <dt>log standard errors for each covariate, numeric vector or matrix w/ dim 1 x n.ecov</dt>
<dd><p>Specified value the same for all time steps</p></dd>

        <dt>estimation option (for all covariates). character string:</dt>
<dd><p><code>"est_1"</code>: Estimated, one value shared among time steps.
          <code>"est_re"</code>: Estimated value for each time step as random effects with two parameters (mean, var)</p></dd>

        <dt>list of two elements.</dt>
<dd><p>First is the matrix of log standard errors or the vector of single values for each covariate as above. 
          Second is a character vector of estimation options (<code>NA</code>, <code>"est_1"</code>,<code>"est_re"</code>) for each covariate. 
          For covariates with non-NA values, values in the first element are ignored.</p></dd>

      
</dl><p></p></dd>

    <dt>$year</dt>
<dd><p>Years corresponding to observations (vector of same length as <code>$mean</code> and <code>$logsigma</code>)</p></dd>

    <dt>$use_obs</dt>
<dd><p>T/F (or 1/0) vector/matrix of the same dimension as <code>$mean</code> and <code>$logsigma</code>.
    Use the observation? Can be used to ignore subsets of the ecov without changing data files.</p></dd>

    <dt>$process_model</dt>
<dd><p>Process model for the ecov time-series. <code>"rw"</code> = random walk, <code>"ar1"</code> = 1st order autoregressive, 
       <code>NA</code> = do not fit</p></dd>

    <dt>$process_mean_vals</dt>
<dd><p>vector of (initial) mean values for the ecov time-series.</p></dd>

    <dt>$process_sig_vals</dt>
<dd><p>vector of (initial) standard deviation values for the ecov time-series.</p></dd>

    <dt>$process_cor_vals</dt>
<dd><p>vector of (initial) correlation values for the ecov time-series.</p></dd>

    <dt>$recruitment_how</dt>
<dd><p>character matrix (n_Ecov x n_stocks) indicating how each ecov affects recruitment for each stock. 
       Options are based on (see <a href="https://www.sciencedirect.com/science/article/pii/S1385110197000221" class="external-link">Iles &amp; Beverton (1998)</a>) 
       combined with the order of orthogonal polynomial of the covariate and has the form "type-lag-order". "type" can be:</p><dl><dt>= "none"</dt>
<dd><p>no effect.</p></dd>

          <dt>= "controlling"</dt>
<dd><p>pre-recruit density-independent mortality.</p></dd>

          <dt>= "limiting"</dt>
<dd><p>maximum recruitment, e.g. ecov determines amount of suitable habitat)</p></dd>

          <dt>= "lethal"</dt>
<dd><p>threshold, i.e. R --&gt; 0 at some ecov value.</p></dd>

          <dt>= "masking"</dt>
<dd><p>metabolic/growth, decreases dR/dS</p></dd>

          <dt>= "directive"</dt>
<dd><p>e.g. behavioral</p></dd>

         
</dl><p>for type other than "none", "lag" can be:</p><dl><dt>= "lag-n"</dt>
<dd><p>lag = n which can be 0,1,2,.... lag-1 implies the covariate in year y affects recruitment in year y+1.</p></dd>

        
</dl><p>for "type" being other than "none", "order" can be:</p><dl><dt>= "linear"</dt>
<dd><p>the covariate effect is linear on the transformed recruitment parameter (e.g., log).</p></dd>

          <dt>= "poly-n"</dt>
<dd><p>orthogonal polynomial where n = 1 (same as "linear"),2,...</p></dd>

        
</dl><p>so "limiting-lag-1-poly-2" would model the covariate affecting recruitment the next year (lag = 1) as a second order orthogonal 
         polynomial (\(b_0 + b_1*ecov + b_2*ecov^2 + ...\)) limiting effect.</p></dd>

    <dt>$M_how</dt>
<dd><p>character array (n_Ecov x n_stocks x n_ages x n_regions) indicating how each ecov affects M by age,stock,region and 
       has the form "lag-order". "lag" can be:</p><dl><dt>= "none"</dt>
<dd><p>no effect.</p></dd>

          <dt>= "lag-n"</dt>
<dd><p>lag = n which can be 0,1,2,.... lag-1 implies the covariate in year y affects M in year y+1.</p></dd>

        
</dl><p>for "lag" being other than "none", "order" can be:</p><dl><dt>= "linear"</dt>
<dd><p>the covariate effect is linear on the transformed M parameter (e.g., log).</p></dd>

          <dt>= "poly-n"</dt>
<dd><p>orthogonal polynomial where n = 1 (same as "linear"),2,...</p></dd>

         
</dl><p></p></dd>

    <dt>$M_effect_map</dt>
<dd><p>integer array (n_stocks x n_ages x n_regions x n_Ecov) indicating which estimated effects are common by age,stock,region.
      If not specified there the same effect is estimated for all M where $M_how is other than "none" for each covariate.</p></dd>

    <dt>$q_how</dt>
<dd><p>character matrix (n_Ecov x n_indices) indicating whether each ecov affects catchability for each index. and has 
     the form "lag-order". "lag" can be:</p><dl><dt>= "none"</dt>
<dd><p>no effect.</p></dd>

          <dt>= "lag-n"</dt>
<dd><p>lag = n which can be 0,1,2,.... lag-1 implies the covariate in year y affects catchability in year y+1.</p></dd>

        
</dl><p>for "lag" being other than "none", "order" can be:</p><dl><dt>= "linear"</dt>
<dd><p>the covariate effect is linear on the transformed catchability parameter (e.g., log).</p></dd>

          <dt>= "poly-n"</dt>
<dd><p>orthogonal polynomial where n = 1 (same as "linear"),2,...</p></dd>

         
</dl><p></p></dd>

    <dt>$move_how</dt>
<dd><p>character array (n_Ecov x n_stocks x n_ages x n_seasons x n_regions x n_regions - 1) indicating whether each ecov 
       affects movement from one region to the others by stock,age,season. and has the form "lag-order". "lag" can be:</p><dl><dt>= "none"</dt>
<dd><p>no effect.</p></dd>

          <dt>= "lag-n"</dt>
<dd><p>lag = n which can be 0,1,2,.... lag-1 implies the covariate in year y affects a movement parameter in year y+1.</p></dd>

        
</dl><p>for "lag" being other than "none", "order" can be:</p><dl><dt>= "linear"</dt>
<dd><p>the covariate effect is linear on the transformed movement parameter (e.g., log).</p></dd>

          <dt>= "poly-n"</dt>
<dd><p>orthogonal polynomial where n = 1 (same as "linear"),2,...</p></dd>

         
</dl><p></p></dd>

    <dt>$move_effect_map</dt>
<dd><p>integer array (n_stocks x n_ages x n_seasons x n_regions x n_regions-1 x n_Ecov) indicating which estimated 
       effects are common by age,stock,region, season etc. If not specified the same effect is estimated for all movement parameters
       where $move_how is other than "none" for each covariate.</p></dd>

    <dt>$beta_R_vals</dt>
<dd><p>n_stocks x n_ecov x max(n_poly_R) array of initial values for effects on recruitment.</p></dd>

    <dt>$beta_M_vals</dt>
<dd><p>n_stocks x n_ages x n_regions x n_ecov x max(n_poly_M) array of initial values for effects on natural mortality.</p></dd>

    <dt>$beta_q_vals</dt>
<dd><p>n_indices x n_ecov x max(n_poly_q) array of initial values for effects on catchability.</p></dd>

    <dt>$beta_mu_vals</dt>
<dd><p>n_stocks x n_ages x n_seasons x n_regions x n_regions - 1 x n_ecov x max(n_poly_move) array of initial values for effects on movement parameters.</p></dd>

  
</dl></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a named list with same elements as the input provided with environmental covariate observations, effects, and model options modified.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="prepare_wham_input.html">prepare_wham_input</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">wham.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"wham"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">path_to_examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"wham"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">asap3</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_asap3_dat.html">read_asap3_dat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_to_examples</span>,<span class="st">"ex1_SNEMAYT.dat"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_to_examples</span>,<span class="st">"GSI.csv"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="st">"rec"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ecov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> label <span class="op">=</span> <span class="st">"GSI"</span>,</span></span>
<span class="r-in"><span> mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">env.dat</span><span class="op">$</span><span class="va">GSI</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> logsigma <span class="op">=</span> <span class="st">'est_1'</span>, <span class="co"># estimate obs sigma, 1 value shared across years</span></span></span>
<span class="r-in"><span> year <span class="op">=</span> <span class="va">env.dat</span><span class="op">$</span><span class="va">year</span>,</span></span>
<span class="r-in"><span> use_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">env.dat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># use all obs (=1)</span></span></span>
<span class="r-in"><span> process_model <span class="op">=</span> <span class="st">'ar1'</span><span class="op">)</span> <span class="co"># "rw" or "ar1"</span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu">set_ecov</span><span class="op">(</span><span class="va">input</span>, ecov <span class="op">=</span> <span class="va">ecov</span><span class="op">)</span> <span class="co">#GSI in the model without any effects</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tim Miller, Brian Stock.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

