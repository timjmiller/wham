<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Project a fit WHAM model — project_wham • wham</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Project a fit WHAM model — project_wham"><meta property="og:description" content="Provides projections/forecasts for an existing (already fit) WHAM model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wham</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li>
      <a href="../articles/ex01_basics.html">Ex 1: The basics</a>
    </li>
    <li>
      <a href="../articles/ex02_CPI_recruitment.html">Ex 2: Recruitment linked to an environmental covariate (Cold Pool Index)</a>
    </li>
    <li>
      <a href="../articles/ex03_projections.html">Ex 3: Projecting / forecasting random effects</a>
    </li>
    <li>
      <a href="../articles/ex4_selectivity.html">Ex 4: Selectivity with time- and age-varying random effects</a>
    </li>
    <li>
      <a href="../articles/ex05_GSI_M.html">Ex 5: Time-varying natural mortality linked to the Gulf Stream Index</a>
    </li>
    <li>
      <a href="../articles/ex06_NAA.html">Ex 6: Numbers-at-age / survival deviations as random effects</a>
    </li>
    <li>
      <a href="../articles/ex07_debug.html">Ex 7: Debugging WHAM models</a>
    </li>
    <li>
      <a href="../articles/ex08_compare.html">Ex 8: Compare ASAP and WHAM model results</a>
    </li>
    <li>
      <a href="../articles/ex09_retro_pred.html">Ex 9: Retrospective predictions</a>
    </li>
    <li>
      <a href="../articles/ex10_simulation.html">Ex 10: Simulations</a>
    </li>
    <li>
      <a href="../articles/ex11_catchability.html">Ex 11: Catchability configurations</a>
    </li>
    <li>
      <a href="../articles/ex12_multistock.html">Ex 12: Multiple stocks, regions</a>
    </li>
    <li>
      <a href="../articles/ex13_no_ASAP.html">Ex 13: WHAM without ASAP</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/timjmiller/wham/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    Source code
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-bullhorn fa-lg"></span>
     
    News
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/timjmiller/wham/issues/" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
<li>
  <a href="https://www.fisheries.noaa.gov/contact/timothy-miller-phd" class="external-link">
    <span class="fas fa-paper-plane fa-lg"></span>
     
    Contact
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Project a fit WHAM model</h1>
    <small class="dont-index">Source: <a href="https://github.com/timjmiller/wham/blob/HEAD/R/project_wham.R" class="external-link"><code>R/project_wham.R</code></a></small>
    <div class="hidden name"><code>project_wham.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides projections/forecasts for an existing (already fit) WHAM model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">project_wham</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  proj.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.yrs <span class="op">=</span> <span class="fl">3</span>, use.last.F <span class="op">=</span> <span class="cn">TRUE</span>, use.avg.F <span class="op">=</span> <span class="cn">FALSE</span>, use.FXSPR <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    use.FMSY <span class="op">=</span> <span class="cn">FALSE</span>, cont.ecov <span class="op">=</span> <span class="cn">TRUE</span>, use.last.ecov <span class="op">=</span> <span class="cn">FALSE</span>, percentFXSPR <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    percentFMSY <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>  n.newton <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  do.sdrep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  MakeADFun.silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save.sdrep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check.version <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TMB.bias.correct <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  TMB.jointPrecision <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>a previously fit wham model</p></dd>


<dt>proj.opts</dt>
<dd><p>a named list with the following components:</p><ul><li><p><code>$n.yrs</code> (integer), number of years to project/forecast. Default = <code>3</code>.</p></li>
<li><p><code>$use.last.F</code> (T/F), use terminal year F for projections. Default = <code>TRUE</code>.</p></li>
<li><p><code>$use.avg.F</code> (T/F), use average of F over certain years for projections. Default = <code>FALSE</code>. Years to average over determined by $avg.yrs defined below.</p></li>
<li><p><code>$use.FXSPR</code> (T/F), calculate and use F at X% SPR for projections. Default = <code>FALSE</code>.</p></li>
<li><p><code>$use.FMSY</code> (T/F), calculate and use FMSY for projections. Default = <code>FALSE</code>.</p></li>
<li><p><code>$proj.F</code> (vector), user-specified fishing mortality for projections. Length must equal <code>n.yrs</code>.</p></li>
<li><p><code>$proj.catch</code> (vector), user-specified aggregate catch for projections. Length must equal <code>n.yrs</code>.</p></li>
<li><p><code>$avg.yrs</code> (vector), specify which years to use to average population attributes (MAA,FAA,WAA,maturity,movement) in projection years. Any BRPs calculated in projection years will also use these. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$cont.ecov</code> (T/F), continue ecov process (e.g. random walk or AR1) for projections. Default = <code>TRUE</code>.</p></li>
<li><p><code>$use.last.ecov</code> (T/F), use terminal year ecov for projections.</p></li>
<li><p><code>$avg.ecov.yrs</code> (vector), specify which years to average the environmental covariate(s) over for projections.</p></li>
<li><p><code>$proj.ecov</code> (matrix), user-specified environmental covariate(s) for projections. <code>n.yrs x n.ecov</code>.</p></li>
<li><p><code>$cont.M.re</code> (T/F), continue M random effects (i.e. AR1_y or 2D AR1) for projections. Default = <code>FALSE</code>. If <code>FALSE</code>, M will be averaged over <code>$avg.yrs.M</code> (which defaults to last 5 model years).</p></li>
<li><p><code>$cont.move.re</code> (T/F), continue any movement random effects for projections. Default = <code>FALSE</code>. If <code>FALSE</code>, movement parameters will be averaged over <code>$avg.yrs.move</code> (which defaults to last 5 model years).</p></li>
<li><p><code>$cont.L.re</code> (T/F), continue any L ("extra mortality rate") random effects for projections. Default = <code>FALSE</code>. If <code>FALSE</code>, L parameters will be averaged over <code>$avg.yrs.L</code> (which defaults to last 5 model years).</p></li>
<li><p><code>$avg.rec.yrs</code> (vector), specify which years to calculate the CDF of recruitment for use in projections. Default = all model years. Only used when recruitment is estimated as fixed effects (SCAA).</p></li>
<li><p><code>$percentFXSPR</code> (scalar), percent of F_XSPR to use for projections, only used if $use.FXSPR = TRUE. For example, to project with F = 75% F_40%SPR, <code>proj.opts$percentFXSPR = 75</code>. Default = 100.</p></li>
<li><p><code>$percentFMSY</code> (scalar), percent of F_MSY to use for projections, only used if $use.FMSY = TRUE and a stock-recruit relationship is assumed. Default = 100.</p></li>
<li><p><code>$proj_F_opt</code> (vector), integers specifying how to configure each year of the projection: 1: use terminal F, 2: use average F, 3: use F at X% SPR, 4: use specified F, 5: use specified catch, 6: use Fmsy. Overrides any of the above specifications.</p></li>
<li><p><code>$proj_Fcatch</code> (vector or matrix), catch or F values to use each projection year: values are not used when using Fmsy, FXSPR, terminal F or average F. Overrides any of the above specifications of proj.F or proj.catch. if vector, total catch or F is supplied else matrix columns should be fleets for fleet-specific F to be found/used (<code>n.yrs</code> x 1 or n_fleets).</p></li>
<li><p><code>$proj_mature</code> (array), user-supplied maturity values for the projection years with dimensions (n_stocks x <code>n.yrs</code> x n_ages).</p></li>
<li><p><code>$proj_waa</code> (3-d array), user-supplied waa values for the projection years with first and third dimensions equal to that of <code>model$input$data$waa</code> (waa source x <code>n.yrs</code> x n_ages).</p></li>
<li><p><code>$proj_R_opt</code> (integer), 1: continue any RE processes for recruitment, 2: make projected recruitment consistent with average recruitment in SPR reference points and cancel any bias correction for NAA in projection years. 3: average recruitment deviations over $avg.yrs.R (if $sigma = "rec") 4: no recruitment deviations (if $sigma = "rec").</p></li>
<li><p><code>$proj_NAA_opt</code> (integer), 1: continue any RE processes for NAA, 2: average NAA deviations over $avg.yrs.NAA. 3: no NAA deviations.</p></li>
<li><p><code>$proj_NAA_init</code> (scalar), the default starting value for all NAA random effects in projection years is exp(10), which may not be large enough for some catch specification. Use this to change the default if a call to project_wham suggests it.</p></li>
<li><p><code>$proj_F_init</code> which F to initialize internal newton search for annual projected F for a given user-specifed catch. Default is 0.1</p></li>
<li><p><code>$avg.yrs.sel</code> list (length = n_fleets), years to average selectivity or FAA for each fleet for projection years. Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.waacatch</code> list (length = n_fleets), years to average weight at age for each fleet for projection years (if $proj_waa is NULL). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.waassb</code> list (length = n_stocks), years to average weight at age for each stock SSB for projection years (if $proj_waa is NULL). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.mature</code> list (length = n_stocks), years to average maturity at age for each stock for projection years (if $proj_mature is NULL). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.L</code> list (length = n_regions), years to average extra mortality at age for each region for projection years (if $cond.L.re = FALSE). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.M</code> list (length = n_stocks, each is a list with length = n_regions), years to average natural mortality at age for each stock and region for projection years (if $cont.M.re = FALSE). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.move</code> list (length = n_stocks, each is a list with length = n_regions), years to average movement rates at age and season for each stock and region (at beginning of interval) for projection years (if $cont.move.re = FALSE). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.R</code> list (length = n_stocks), years to average recruitment deviations for each stock and region for projection years (if $proj_R_opt = 3). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
<li><p><code>$avg.yrs.NAA</code> list (length = n_stocks, each is a list with length = n_regions), years to average NAA deviations for each stock and region for projection years (if $proj_NAA_opt = 2). Any BRPs calculated in projection years will also use this. Default = last 5 years, <code>tail(model$years, 5)</code>.</p></li>
</ul></dd>


<dt>n.newton</dt>
<dd><p>integer, number of additional Newton steps after optimization. Passed to <code><a href="fit_tmb.html">fit_tmb</a></code>. Default = <code>0</code> for projections.</p></dd>


<dt>do.sdrep</dt>
<dd><p>T/F, calculate standard deviations of model parameters? See <code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">sdreport</a></code>. Default = <code>TRUE</code>.</p></dd>


<dt>MakeADFun.silent</dt>
<dd><p>T/F, Passed to silent argument of <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">TMB::MakeADFun</a></code>. Default = <code>FALSE</code>.</p></dd>


<dt>save.sdrep</dt>
<dd><p>T/F, save the full <code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">TMB::sdreport</a></code> object? If <code>FALSE</code>, only save <code><a href="https://rdrr.io/pkg/TMB/man/summary.sdreport.html" class="external-link">summary.sdreport</a></code> to reduce model object file size. Default = <code>TRUE</code>.</p></dd>


<dt>check.version</dt>
<dd><p>T/F check whether version WHAM and TMB for fitted model match that of the version of WHAM using for projections. Default = <code>TRUE</code>.</p></dd>


<dt>TMB.bias.correct</dt>
<dd><p>T/F whether to use the bias.correct feature of TMB::sdreport. Default = <code>FALSE</code>.</p></dd>


<dt>TMB.jointPrecision</dt>
<dd><p>T/F whether to return the joint precision matrix for the fixed and random effects from TMB::sdreport. Default = <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a projected WHAM model with additional output if specified:</p>
<p></p>
<dl><dt><code>$rep</code></dt>
<dd><p>List of derived quantity estimates (see examples)</p></dd>

    <dt><code>$sdrep</code></dt>
<dd><p>Parameter estimates (and standard errors if <code>do.sdrep=TRUE</code>)</p></dd>

    <dt><code>$peels</code></dt>
<dd><p>Retrospective analysis (if <code>do.retro=TRUE</code>)</p></dd>

    <dt><code>$osa</code></dt>
<dd><p>One-step-ahead residuals (if <code>do.osa=TRUE</code>)</p></dd>

  
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>WHAM implements five options for handling fishing mortality in the projections.
Exactly one of these must be specified in <code>proj.opts</code>:</p><ul><li><p>Use last year F (default). Set <code>proj.opts$use.last.F = TRUE</code>. WHAM will use F in the terminal model year for projections.</p></li>
<li><p>Use average F. Set <code>proj.opts$use.avg.F = TRUE</code>. WHAM will use F averaged over <code>proj.opts$avg.yrs</code> for projections (as is done for M-, maturity-, and weight-at-age).</p></li>
<li><p>Use F at X% SPR. Set <code>proj.opts$use.FXSPR = TRUE</code>. WHAM will calculate F at X% SPR.</p></li>
<li><p>Specify F. Provide <code>proj.opts$proj.F</code>, an F vector with length = <code>n.yrs</code>.</p></li>
<li><p>Specify catch. Provide <code>proj.opts$proj.catch</code>, a vector of aggregate catch with length = <code>n.yrs</code>. WHAM will calculate F to get specified catch.</p></li>
</ul><p><code>proj.opts$avg.yrs</code> controls which years the following will be averaged over in the projections:</p><ul><li><p>Maturity-at-age</p></li>
<li><p>Weight-at-age</p></li>
<li><p>Natural mortality-at-age</p></li>
<li><p>Fishing mortality-at-age (if <code>proj.opts$use.avgF = TRUE</code>)</p></li>
</ul><p>If fitting a model with recruitment estimated freely in each year, i.e. as fixed effects as in ASAP, WHAM handles recruitment 
in the projection years similarly to using the empirical cumulative distribution function. WHAM does this by calculating the mean
and standard deviation of log(R) over all model years (default) or a specified subset of years (<code>proj.opts$avg.rec.yrs</code>). WHAM then
treats recruitment in the projections as a random effect with this mean and SD, i.e. log(R) ~ N(meanlogR, sdlogR).</p>
<p>WHAM implements four options for handling the environmental covariate(s) in the projections.
Exactly one of these must be specified in <code>proj.opts</code> if <code>ecov</code> is in the model:</p><dl><dt>(Default) Continue ecov process model (e.g. random walk, AR1)</dt>
<dd><p>Set <code>$cont.ecov = TRUE</code>. WHAM will estimate the ecov process in projection years (i.e. continue the random walk / AR1 process).</p></dd>

    <dt>Use last year ecov(s)</dt>
<dd><p>Set <code>$use.last.ecov = TRUE</code>. WHAM will use ecov value from the terminal year (of population model) for projections.</p></dd>

    <dt>Use average ecov(s)</dt>
<dd><p>Provide <code>$avg.yrs.ecov</code>, a vector specifying which years to average over the environmental covariate(s) for projections.</p></dd>

    <dt>Specify <code>ecov</code></dt>
<dd><p>Provide <code>$proj.ecov</code>, a matrix of user-specified environmental covariate(s) to use for projections. Dimensions must be # projection years (<code>proj.opts$n.yrs</code>) x # ecovs (<code>ncols(ecov$mean)</code>).</p></dd>

  
</dl><p>If the original model fit the ecov in years beyond the population model, WHAM will use the already-fit
ecov values for the projections. If the ecov model extended at least <code>proj.opts$n.yrs</code> years
beyond the population model, then none of the above need be specified.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="fit_wham.html">fit_wham</a></code>, <code><a href="fit_tmb.html">fit_tmb</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"input4_SNEMAYT"</span><span class="op">)</span> <span class="co"># load SNEMA yellowtail flounder input data and model settings</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input4_SNEMAYT</span><span class="op">)</span> <span class="co"># using default values (do.proj=T)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input4_SNEMAYT</span>, do.retro<span class="op">=</span><span class="cn">F</span>, do.osa<span class="op">=</span><span class="cn">F</span>, do.proj<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="co"># fit model without projections, retro analysis, or OSA residuals</span></span></span>
<span class="r-in"><span><span class="va">mod_proj</span> <span class="op">&lt;-</span> <span class="fu">project_wham</span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span> <span class="co"># add projections to previously fit model, using default values: use.lastF = TRUE, n.yrs = 3, avg.yrs = last 5 years</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mod_proj</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span> <span class="co"># list of derived quantities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">mod_proj</span><span class="op">$</span><span class="va">rep</span><span class="op">$</span><span class="va">SSB</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># get 3-year projected SSB estimates (weight, not numbers)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_proj</span><span class="op">$</span><span class="va">sdrep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co"># list of estimated parameters and derived quanitites with SE</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="st">"log_SSB"</span>,<span class="op">]</span> <span class="co"># SSB estimates with SE</span></span></span>
<span class="r-in"><span><span class="va">ssb.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span> <span class="co"># calculate 95% CI</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ssb.mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSB"</span>,<span class="st">"SSB_se"</span>,<span class="st">"SSB_lower"</span>,<span class="st">"SSB_upper"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ssb.mat</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># 3-year projected SSB estimates with SE and 95% CI</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tim Miller, Brian Stock.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

