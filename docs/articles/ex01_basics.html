<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ex 1: The basics • wham</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Ex 1: The basics">
<meta property="og:description" content="wham">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wham</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li>
      <a href="../articles/ex01_basics.html">Ex 1: The basics</a>
    </li>
    <li>
      <a href="../articles/ex02_CPI_recruitment.html">Ex 2: Recruitment linked to an environmental covariate (Cold Pool Index)</a>
    </li>
    <li>
      <a href="../articles/ex03_projections.html">Ex 3: Projecting / forecasting random effects</a>
    </li>
    <li>
      <a href="../articles/ex4_selectivity.html">Ex 4: Selectivity with time- and age-varying random effects</a>
    </li>
    <li>
      <a href="../articles/ex05_GSI_M.html">Ex 5: Time-varying natural mortality linked to the Gulf Stream Index</a>
    </li>
    <li>
      <a href="../articles/ex06_NAA.html">Ex 6: Numbers-at-age / survival deviations as random effects</a>
    </li>
    <li>
      <a href="../articles/ex07_debug.html">Ex 7: Debugging WHAM models</a>
    </li>
    <li>
      <a href="../articles/ex08_compare.html">Ex 8: Compare ASAP and WHAM model results</a>
    </li>
    <li>
      <a href="../articles/ex09_retro_pred.html">Ex 9: Retrospective predictions</a>
    </li>
    <li>
      <a href="../articles/ex10_simulation.html">Ex 10: Simulations</a>
    </li>
    <li>
      <a href="../articles/ex11_catchability.html">Ex 11: Catchability configurations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/timjmiller/wham/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    Source code
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-bullhorn fa-lg"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/timjmiller/wham/issues/" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
<li>
  <a href="https://www.fisheries.noaa.gov/contact/timothy-miller-phd" class="external-link">
    <span class="fas fa-paper-plane fa-lg"></span>
     
    Contact
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ex 1: The basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/timjmiller/wham/blob/HEAD/vignettes/ex01_basics.Rmd" class="external-link"><code>vignettes/ex01_basics.Rmd</code></a></small>
      <div class="hidden name"><code>ex01_basics.Rmd</code></div>

    </div>

    
    
<p>In this vignette we walk through an example using the
<code>wham</code> (WHAM = the Woods Hole Assessment Model) package to
run a state-space age-structured stock assessment model. WHAM is a
generalization of code written for <a href="https://doi.org/10.1139/cjfas-2015-0339" class="external-link">Miller et al. (2016)</a>,
and in this example we apply WHAM to the same stock as in Miller et
al. (2016), Southern New England / Mid-Atlantic Yellowtail Flounder.
Here, we demonstrate the basic <code>wham</code> workflow:</p>
<ol style="list-style-type: decimal">
<li><p>Load <code>wham</code> and data</p></li>
<li>
<p>Specify several (slightly different) models:</p>
<ul>
<li><p>m1: statistical catch-at-age (SCAA) model, but with recruitment
estimated as random effects; multinomial age-compositions</p></li>
<li><p>m2: as m1, but with logistic normal age-compositions</p></li>
<li><p>m3: full state-space model (numbers at all ages are random
effects), multinomial age-compositions</p></li>
<li><p>m4: full state-space model, logistic normal
age-compositions</p></li>
</ul>
</li>
<li><p>Fit models and check for convergence</p></li>
<li><p>Compare models by AIC and Mohn’s rho (retrospective
analysis)</p></li>
<li><p>Review plots of input data, diagnostics, and results.</p></li>
</ol>
<div class="section level2">
<h2 id="load-data">1. Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>We assume you have already read the <a href="https://timjmiller.github.io/wham/">Introduction</a> and installed
<code>wham</code> and its dependencies. If not, you should be able to
install using the <code>remotes</code> or <code>pak</code> packages:
<code>remotes::install_github("timjmiller/wham", dependencies=TRUE)</code>.
<code>pak::pkg_install("timjmiller/wham")</code></p>
<p>Open R and load the <code>wham</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://timjmiller.github.io/wham/">wham</a></span><span class="op">)</span></span></code></pre></div>
<p>For a clean, runnable <code>.R</code> script, look at
<code>ex1_basics.R</code> in the <code>example_scripts</code> folder of
the <code>wham</code> package. You can run this entire example script
with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wham.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"wham"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wham.dir</span>, <span class="st">"example_scripts"</span>, <span class="st">"ex1_basics.R"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s create a directory for this analysis:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choose a location to save output, otherwise will be saved in working directory</span></span>
<span><span class="va">write.dir</span> <span class="op">&lt;-</span> <span class="st">"choose/where/to/save/output"</span> <span class="co">#e.g., tempdir(check=TRUE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">write.dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">write.dir</span><span class="op">)</span></span></code></pre></div>
<p>WHAM was built by modifying the ADMB-based ASAP model code <a href="http://sedarweb.org/docs/wsupp/S12RD06%20ASAPdoc.pdf" class="external-link">(Legault and
Restrepo 1999)</a>, and is designed to take an ASAP3 .dat file as input.
We generally assume in <code>wham</code> that you have an existing ASAP3
.dat file. If you are not familiar with ASAP3 input files, see the ASAP
<a href="https://github.com/cmlegault/ASAPplots/tree/master/pdf" class="external-link">documentation</a>
and <a href="https://nmfs-fish-tools.github.io/ASAP/" class="external-link">code</a>. For this
vignette, an example ASAP3 input file is provided.</p>
<p>Read the ASAP3 .dat file into R:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_to_examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"wham"</span><span class="op">)</span></span>
<span><span class="va">asap3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_asap3_dat.html">read_asap3_dat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_to_examples</span>,<span class="st">"ex1_SNEMAYT.dat"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-model">2. Specify model<a class="anchor" aria-label="anchor" href="#specify-model"></a>
</h2>
<p>We use the <code><a href="../reference/prepare_wham_input.html">prepare_wham_input()</a></code> function to specify the
model name and any settings that differ from the ASAP3 file. Our first
model will use:</p>
<ul>
<li>recruitment model: random about mean, no S-R function
(<code>recruit_model = 2</code>)</li>
<li>recruitment deviations: independent random effects
(<code>NAA_re = list(sigma="rec", cor="iid")</code>)</li>
<li>selectivity: age-specific (fix sel=1 for ages 4-5 in fishery, age 4
in index1, and ages 2-4 in index2)</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, recruit_model<span class="op">=</span><span class="fl">2</span>, model_name<span class="op">=</span><span class="st">"Ex 1: SNEMA Yellowtail Flounder"</span>,</span>
<span>  selectivity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"age-specific"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    re<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    initial_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fix_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma<span class="op">=</span><span class="st">"rec"</span>, cor<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note the text that is printed to the console by this command. The
function attempts to provide some description of assumptions being made
for this model configuration as well as some changes in default
configurations in recent versions.</p>
<p>The stock-recruit model options in WHAM are:</p>
<ul>
<li>1 = random walk,</li>
<li>2 = random about mean (default),</li>
<li>3 = Beverton-Holt, and</li>
<li>4 = Ricker</li>
</ul>
<p>Note that the parameterization of age-specific selectivity is
specific to SNEMA yellowtail flounder. We will use age-specific
selectivity parameters for the first three selectivity blocks.
Selectivity blocks define a selectivity configuration that can be used
in one or more fleets or surveys over any set of years in the model.
<code><a href="../reference/prepare_wham_input.html">prepare_wham_input()</a></code> fixes age-specific parameters at zero
if there are any age classes without any observations where the
selectivity block is applied. The function configures all other
age-specific parameters to be estimated. Generally there may be
confounding of the selectivity parameters with either fully-selected
fishing mortality (for fleets) or catchability (for surveys), so
selectivity parameters for one or more ages would need to be fixed to
allow convergence. An initial fit with all selectivity parameters freely
estimated can be useful in determining which age(s) to fix selectivity
at 1. In the code above, we have already determined the ages to fix
selectivity at 1 (ages 4-5 in fishery, age 4 in index 1, and ages 2-4 in
index 2). If you are interested in more details and options for
selectivity in WHAM, see <a href="https://timjmiller.github.io/wham/articles/ex4_selectivity.html">Example
4</a> and <code><a href="../reference/prepare_wham_input.html">prepare_wham_input()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="fit-model-and-check-for-convergence">3. Fit model and check for convergence<a class="anchor" aria-label="anchor" href="#fit-model-and-check-for-convergence"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input1</span>, do.osa <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># turn off OSA residuals to save time in ex</span></span></code></pre></div>
<p>By default, <code><a href="../reference/fit_wham.html">fit_wham()</a></code> uses 3 extra Newton steps to
reduce the absolute value of the gradient (<code>n.newton = 3</code>)
and estimates standard errors for derived parameters
(<code>do.sdrep = TRUE</code>). <code><a href="../reference/fit_wham.html">fit_wham()</a></code> also does a
retrospective analysis with 7 peels by default
(<code>do.retro = TRUE</code>, <code>n.peels = 7</code>). For more
details, see <code><a href="../reference/fit_wham.html">fit_wham()</a></code>.</p>
<p>We need to check that <code>m1</code> converged
(<code>m1$opt$convergence</code> should be 0, and the maximum absolute
value of the gradient vector should be &lt; 1e-06). Convergence issues
may indicate that a model is misspecified or overparameterized. To help
diagnose these problems, <code><a href="../reference/fit_wham.html">fit_wham()</a></code> includes a
<code>do.check</code> option to run an internal
<code>check_estimability</code> function <a href="https://github.com/kaskr/TMB_contrib_R/blob/master/TMBhelper/R/check_estimability.R" class="external-link">originally
written by Jim Thorson</a>. <code>do.check = FALSE</code> by default. To
turn on, set <code>do.check = TRUE</code>. See
<code><a href="../reference/fit_wham.html">fit_wham()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_convergence.html">check_convergence</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stats:nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 1.56e-12 </span></span>
<span><span class="co">#&gt; Max gradient parameter: logit_q </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre>
<div class="section level3">
<h3 id="fit-models-m2-m4">Fit models <code>m2</code>-<code>m4</code><a class="anchor" aria-label="anchor" href="#fit-models-m2-m4"></a>
</h3>
<p>The second model, <code>m2</code>, is like the first, but changes all
the age composition likelihoods from multinomial to logistic normal
(treating 0 observations as missing):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, recruit_model<span class="op">=</span><span class="fl">2</span>, model_name<span class="op">=</span><span class="st">"Ex 1: SNEMA Yellowtail Flounder"</span>,</span>
<span>  selectivity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"age-specific"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    re<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    initial_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fix_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma<span class="op">=</span><span class="st">"rec"</span>, cor<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span>,</span>
<span>  age_comp <span class="op">=</span> <span class="st">"logistic-normal-miss0"</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input2</span>, do.osa <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># turn off OSA residuals to save time</span></span></code></pre></div>
<p>Check that <code>m2</code> converged:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_convergence.html">check_convergence</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stats:nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 1.03e-11 </span></span>
<span><span class="co">#&gt; Max gradient parameter: index_paa_pars </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre>
<p>The third, <code>m3</code>, is a full state-space model where numbers
at all ages are random effects
(<code>NAA_re$sigma = "rec+1"</code>):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, recruit_model<span class="op">=</span><span class="fl">2</span>, model_name<span class="op">=</span><span class="st">"Ex 1: SNEMA Yellowtail Flounder"</span>,</span>
<span>  selectivity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"age-specific"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    re<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    initial_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fix_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma<span class="op">=</span><span class="st">"rec+1"</span>, cor<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input3</span>, do.osa <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># turn off OSA residuals to save time</span></span></code></pre></div>
<p>Check that <code>m3</code> converged:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_convergence.html">check_convergence</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stats:nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 3.04e-11 </span></span>
<span><span class="co">#&gt; Max gradient parameter: logit_selpars </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre>
<p>The last, <code>m4</code>, is like <code>m3</code>, but again changes
all the age composition likelihoods to logistic normal:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, recruit_model<span class="op">=</span><span class="fl">2</span>, model_name<span class="op">=</span><span class="st">"Ex 1: SNEMA Yellowtail Flounder"</span>,</span>
<span>  selectivity<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"age-specific"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    re<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>    initial_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    fix_pars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  NAA_re <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma<span class="op">=</span><span class="st">"rec+1"</span>, cor<span class="op">=</span><span class="st">"iid"</span><span class="op">)</span>,</span>
<span>  age_comp <span class="op">=</span> <span class="st">"logistic-normal-miss0"</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input4</span>, do.osa <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># turn off OSA residuals to save time</span></span></code></pre></div>
<p>Check that <code>m4</code> converged: The max absolute gradient is
not good.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_convergence.html">check_convergence</a></span><span class="op">(</span><span class="va">m4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stats:nlminb thinks the model has NOT converged: mod$opt$convergence != 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 9.97e-01 </span></span>
<span><span class="co">#&gt; Max gradient parameter: F_pars </span></span>
<span><span class="co">#&gt; TMB:sdreport() was not performed for this model</span></span></code></pre>
<p>Try refitting starting at the previously estimated values. This helps
sometimes.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input4</span><span class="op">$</span><span class="va">par</span> <span class="op">&lt;-</span> <span class="va">m4</span><span class="op">$</span><span class="va">parList</span> <span class="co">#best estimates so far</span></span>
<span><span class="va">m4_good</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input4</span>, do.osa <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="co"># turn off OSA residuals to save time</span></span></code></pre></div>
<p>Now convergence is good.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_convergence.html">check_convergence</a></span><span class="op">(</span><span class="va">m4_good</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; stats:nlminb thinks the model has converged: mod$opt$convergence == 0</span></span>
<span><span class="co">#&gt; Maximum gradient component: 2.40e-10 </span></span>
<span><span class="co">#&gt; Max gradient parameter: index_paa_pars </span></span>
<span><span class="co">#&gt; TMB:sdreport() was performed successfully for this model</span></span></code></pre>
<p>Now, add the One-step-ahead residuals to the model fit using the
<code>make_osa_residuals</code> function</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4_good</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_osa_residuals.html">make_osa_residuals</a></span><span class="op">(</span><span class="va">m4_good</span><span class="op">)</span> <span class="co">#returns the model with the residuals added.</span></span></code></pre></div>
<p>Store all models together in one (named) list:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1<span class="op">=</span><span class="va">m1</span>, m2<span class="op">=</span><span class="va">m2</span>, m3<span class="op">=</span><span class="va">m3</span>, m4<span class="op">=</span><span class="va">m4_good</span><span class="op">)</span></span></code></pre></div>
<p>Since the retrospective analyses take a few minutes to run, you may
want to save the output for later use:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="st">"mods"</span>, file<span class="op">=</span><span class="st">"ex1_models.RData"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compare-models">4. Compare models<a class="anchor" aria-label="anchor" href="#compare-models"></a>
</h2>
<p><code><a href="../reference/compare_wham_models.html">compare_wham_models()</a></code> will make 1) a table comparing
multiple WHAM model fits using AIC and Mohn’s rho, and 2) plots of key
output (e.g. SSB, F, recruitment, reference points).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_wham_models.html">compare_wham_models</a></span><span class="op">(</span><span class="va">mods</span>, table.opts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fname<span class="op">=</span><span class="st">"ex1_table"</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      dAIC     AIC  rho_R rho_SSB rho_Fbar</span></span>
<span><span class="co">#&gt; m4    0.0 -1472.4 0.3474  0.0584  -0.0416</span></span>
<span><span class="co">#&gt; m2  306.0 -1166.4 5.1190 -0.0205   0.0174</span></span>
<span><span class="co">#&gt; m3 5573.6  4101.2 0.1271  0.0290  -0.0230</span></span>
<span><span class="co">#&gt; m1 6312.9  4840.5 0.8207  0.1840  -0.1748</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">best</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "m4"</span></span></code></pre>
<p>By default, <code><a href="../reference/compare_wham_models.html">compare_wham_models()</a></code> sorts the model
comparison table with lowest (best) AIC at the top, and saves it as
<code>model_comparison.csv</code>. However, in this example the models
with alternative likelihoods for the age composition observations are
not comparable due to differences in how the observations are defined.
Still, the models that treat the age composition observations in the
same way can be compared to evaluate whether stochasticity in abundances
at age provides better performance, i.e. <code>m1</code>
vs. <code>m3</code> (both multinomial) and <code>m2</code>
vs. <code>m4</code> (both logistic normal).</p>
<p>The comparison plots are stored by default in the
<code>compare_png</code> folder.</p>
<div class="section level3">
<h3 id="project-the-best-model">Project the best model<a class="anchor" aria-label="anchor" href="#project-the-best-model"></a>
</h3>
<p>Let’s do projections for the best model, <code>m4</code>, using the
default settings (see <code><a href="../reference/project_wham.html">project_wham()</a></code>):</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m4_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_wham.html">project_wham</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">m4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot-input-data-diagnostics-and-results">5. Plot input data, diagnostics, and results<a class="anchor" aria-label="anchor" href="#plot-input-data-diagnostics-and-results"></a>
</h2>
<p>There are various options for creating WHAM output. The default is to
create a self-contained html file using Rmarkdown and individual plot
files (.png) that are organised within subdirectories of
<code>plots_png</code>. The html file also includes tables of estimates
for fundamental parameters and abundance and fishing mortality at age.
On Windows you may need to use Chrome or Internet Explorer to view the
<code>.html</code> (there have been issues using Firefox on Windows but
not Linux).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_wham_output.html">plot_wham_output</a></span><span class="op">(</span>mod<span class="op">=</span><span class="va">m4_proj</span>, out.type<span class="op">=</span><span class="st">'html'</span><span class="op">)</span> <span class="co">#default</span></span></code></pre></div>
<div class="figure">
<img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/wham_html_diagnostics.png" style="width:75.0%" alt=""><p class="caption">Example HTML file created by
<code>plot_wham_output(mod=m4, out.type='html')</code> for plots.</p>
</div>
<div class="figure">
<img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/wham_html_tables.png" style="width:75.0%" alt=""><p class="caption">Example HTML file created by
<code>plot_wham_output(mod=m4, out.type='html')</code> for tables.</p>
</div>
<p>Setting <code>out.type='pdf'</code> saves the plots organized into 6
<code>.pdf</code> files corresponding to the tabs in the
<code>.html</code> file (Diagnostics, Input Data, Results, Reference
Points, Retrospective, and Misc). This option will also generate a pdf
of the same tables as those under the <code>html</code> option.</p>
<p>Many plots are generated—here we display some examples:</p>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/Index4panel_index_2_region_1.png" style="width:45.0%" alt="Index 2 4-panel"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/likelihood.png" style="width:45.0%" alt="Likelihood components"></p>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/NAA_4panel_stock_1_region_1_age_1.png" style="width:45.0%" alt="Conditional expected and posterior estimates of age-1 abundance (recruitment)."><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/NAA_4panel_stock_1_region_1_age_5.png" style="width:45.0%" alt="Conditional expected and posterior estimates of age-5 abundance."></p>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/Catch_age_comp_index_1_region_1.png" style="width:45.0%" alt="Fit to Index 1 age composition data."><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/Catch_age_comp_resids_index_1.png" style="width:45.0%" alt="Residuals for Index 1 age composition."></p>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSA+resid_catch_4panel_fleet_1.png" style="width:30.0%" alt="One-step-ahead residuals Fleet 1 catch."><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSAresid_catch_4panel_index_1.png" style="width:30.0%" alt="One-step-ahead residuals Index 1 catch."><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSAresid_catch_4panel_index_2.png" style="width:30.0%" alt="One-step-ahead residuals Index 2 catch."><a href="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSA_resid_paa_6panel_fleet_1.png" width="30%" class="external-link">One-step-ahead residuals Fleet 1 age composition.</a> <a href="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSA_resid_paa_6panel_index_1.png" width="30%" class="external-link">One-step-ahead residuals Index 1 age composition.</a> <a href="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/OSA_resid_paa_6panel_index_2.png" width="30%" class="external-link">One-step-ahead residuals Index 2 age composition.</a></p>
</div>
<div class="section level3">
<h3 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/catch_by_fleet.png" style="width:45.0%" alt="Catch"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/index.png" style="width:45.0%" alt="Indices of abundance"></p>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/SSB_F_trend.png" style="width:45.0%" alt="SSB and F"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/SSB_at_age_proportion_stock_1.png" style="width:45.0%" alt="Proportion of SSB at age"></p>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/SSB_Rec_loglog_stock_1.png" style="width:45.0%" alt="SSB-Rec on log-scale"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/Selectivity_fleet_1_region_1.png" style="width:45.0%" alt="Selectivity Fleet 1"></p>
</div>
<div class="section level3">
<h3 id="reference-points">Reference Points<a class="anchor" aria-label="anchor" href="#reference-points"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/Kobe_status.png" style="width:45.0%" alt="Stock status (Kobe plot)"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/FSPR_relative.png" style="width:45.0%" alt="Status relative to SPR"></p>
</div>
<div class="section level3">
<h3 id="retrospective">Retrospective<a class="anchor" aria-label="anchor" href="#retrospective"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/stock_1_SSB_retro.png" style="width:45.0%" alt="SSB with 7 peels"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/stock_1_SSB_retro_relative.png" style="width:45.0%" alt="Mohn’s rho (SSB) with 7 peels"></p>
</div>
<div class="section level3">
<h3 id="misc">Misc<a class="anchor" aria-label="anchor" href="#misc"></a>
</h3>
<p><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/catch_curves_fleet_1_region_1_obs.png" style="width:45.0%" alt="Catch curves (Fleet 1 observed)"><img src="https://raw.githubusercontent.com/timjmiller/wham/master/vignettes/ex1_plots/catch_at_age_consistency_obs_fleet_1_region_1.png" style="width:45.0%" alt="Catch at age consistency (Fleet 1 observed)"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tim Miller, Brian Stock.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
