<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ex 13: Using WHAM without ASAP • wham</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Ex 13: Using WHAM without ASAP">
<meta property="og:description" content="wham">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wham</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/index.html">Overview</a>
    </li>
    <li>
      <a href="../articles/ex01_basics.html">Ex 1: The basics</a>
    </li>
    <li>
      <a href="../articles/ex02_CPI_recruitment.html">Ex 2: Recruitment linked to an environmental covariate (Cold Pool Index)</a>
    </li>
    <li>
      <a href="../articles/ex03_projections.html">Ex 3: Projecting / forecasting random effects</a>
    </li>
    <li>
      <a href="../articles/ex4_selectivity.html">Ex 4: Selectivity with time- and age-varying random effects</a>
    </li>
    <li>
      <a href="../articles/ex05_GSI_M.html">Ex 5: Time-varying natural mortality linked to the Gulf Stream Index</a>
    </li>
    <li>
      <a href="../articles/ex06_NAA.html">Ex 6: Numbers-at-age / survival deviations as random effects</a>
    </li>
    <li>
      <a href="../articles/ex07_debug.html">Ex 7: Debugging WHAM models</a>
    </li>
    <li>
      <a href="../articles/ex08_compare.html">Ex 8: Compare ASAP and WHAM model results</a>
    </li>
    <li>
      <a href="../articles/ex09_retro_pred.html">Ex 9: Retrospective predictions</a>
    </li>
    <li>
      <a href="../articles/ex10_simulation.html">Ex 10: Simulations</a>
    </li>
    <li>
      <a href="../articles/ex11_catchability.html">Ex 11: Catchability configurations</a>
    </li>
    <li>
      <a href="../articles/ex12_multistock.html">Ex 12: Multiple stocks, regions</a>
    </li>
    <li>
      <a href="../articles/ex13_no_ASAP.html">Ex 13: WHAM without ASAP</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/timjmiller/wham/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
    Source code
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-bullhorn fa-lg"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/timjmiller/wham/issues/" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
<li>
  <a href="https://www.fisheries.noaa.gov/contact/timothy-miller-phd" class="external-link">
    <span class="fas fa-paper-plane fa-lg"></span>
     
    Contact
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ex 13: Using WHAM without ASAP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/timjmiller/wham/blob/HEAD/vignettes/ex13_no_ASAP.Rmd" class="external-link"><code>vignettes/ex13_no_ASAP.Rmd</code></a></small>
      <div class="hidden name"><code>ex13_no_ASAP.Rmd</code></div>

    </div>

    
    
<p>In this vignette we show how to create input objects with
prepare_wham_input, but without an ASAP .dat file. However, we will work
from ASAP files and extract the necessary components. We compare models
fit with asap inputs and those built without calling an asap object.
This exercise is peformed for 1 and 2 stocks.</p>
<ol style="list-style-type: decimal">
<li><p>Load wham library and set up a directory for work</p></li>
<li>
<p>Create inputs for single stock model</p>
<ul>
<li>Load asap file</li>
<li>create arguments to <code>prepare_wham_input</code> and functions
specific to different model components (e.g., <code>set_M</code>)</li>
<li>create input by passing all arguments to
<code>prepare_wham_input</code>
</li>
<li>create input by passing arguments to specific functions
sequentially</li>
<li>create input from asap object</li>
<li>show that model fit is identical for all three inputs</li>
</ul>
</li>
<li>
<p>Create inputs for 2 stock, 2 region model</p>
<ul>
<li>Load asap files</li>
<li>create arguments to <code>prepare_wham_input</code> and functions
specific to different model components (e.g., <code>set_M</code>)</li>
<li>create input by passing all arguments to
<code>prepare_wham_input</code>
</li>
<li>create input by passing arguments to specific functions
sequentially</li>
<li>create input from asap object</li>
<li>show that model fit is identical for all three inputs</li>
</ul>
</li>
</ol>
<div class="section level2">
<h2 id="getting-started">1. Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>If you have not already installed <code>wham</code>, see the <a href="https://timjmiller.github.io/wham/">Introduction</a> for
instructions.</p>
<p>Open R and load the <code>wham</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://timjmiller.github.io/wham/">wham</a></span><span class="op">)</span></span></code></pre></div>
<p>Create a directory for this analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choose a location to save output, otherwise will be saved in working directory</span></span>
<span><span class="va">write.dir</span> <span class="op">&lt;-</span> <span class="st">"choose/where/to/save/output"</span> <span class="co">#e.g., tempdir(check=TRUE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">write.dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">write.dir</span><span class="op">)</span></span></code></pre></div>
<p>For a clean, runnable <code>.R</code> script, look at
<code>ex13_no_ASAP.R</code> in the <code>example_scripts</code> folder
of the <code>wham</code> package. You can run this entire example script
with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wham.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"wham"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wham.dir</span>, <span class="st">"example_scripts"</span>, <span class="st">"ex13_no_ASAP.R"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-inputs-to-fit-a-single-stock-model">2. Creating inputs to fit a single stock model<a class="anchor" aria-label="anchor" href="#creating-inputs-to-fit-a-single-stock-model"></a>
</h2>
<p>Read the ASAP3 .dat file into R and create an input from it:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_to_examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"wham"</span><span class="op">)</span></span>
<span><span class="va">asap3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_asap3_dat.html">read_asap3_dat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_to_examples</span>,<span class="st">"ex2_SNEMAYT.dat"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span><span class="op">)</span> </span></code></pre></div>
<p>We will extract all of the elements of the <code>input</code> needed
to create a wham input object without using to the <code>asap3</code>
object in <code>prepare_wham_input</code>. To adapt this for an analysis
without an asap dat file, we only need to supply each of the element to
prepare_wham_input structured correctly.</p>
<p>There is a <code>basic_info</code> argument to
<code>prepare_wham_input</code> that provides a list of various “basic”
model structure information:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basic_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_stocks <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    n_seasons <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    n_fleets <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    ages <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_ages</span>,</span>
<span>    n_fleets <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_fleets</span>,</span>
<span>    fracyr_SSB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">fracyr_SSB</span><span class="op">)</span>, <span class="co">#(n_years x n_stocks)</span></span>
<span>    maturity <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">mature</span>, <span class="co">#(n_stocks x n_years x n_ages)</span></span>
<span>    years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="co">#(n_years)</span></span>
<span>    waa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa</span>, <span class="co">#(any no. x n_years x n_ages)</span></span>
<span>    waa_pointer_ssb <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_ssb</span>, <span class="co">#(n_stocks)</span></span>
<span>    spawn_regions <span class="op">=</span> <span class="fl">1</span>, <span class="co">#(n_stocks)</span></span>
<span>    spawn_seasons <span class="op">=</span> <span class="fl">1</span> <span class="co">#(n_stocks)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>There is a <code>catch_info</code> argument to
<code>prepare_wham_input</code> that provides a list of various catch
data and fleet information:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">catch_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_fleets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch</span><span class="op">)</span>, <span class="co">#(n_fleets)</span></span>
<span>    agg_catch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    agg_catch_cv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch_sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    catch_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">catch_paa</span>, <span class="co">#(n_fleets x n_years x n_ages)</span></span>
<span>    use_catch_paa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_catch_paa</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets), 0: don't use, 1: use</span></span>
<span>    catch_Neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">catch_Neff</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    selblock_pointer_fleets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">selblock_pointer_fleets</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    waa_pointer_fleets <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_fleets</span>, <span class="co">#(n_fleets)</span></span>
<span>    fleet_regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_fleets</span><span class="op">)</span> <span class="co">#(n_fleets)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Similarly, there is an <code>index_info</code> argument to
<code>prepare_wham_input</code> that provides a list of various index
data and information:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_indices</span><span class="op">)</span>,</span>
<span>    agg_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    units_indices <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">units_indices</span>, <span class="co">#(n_indices) 1: biomass 2: numbers</span></span>
<span>    units_index_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">units_index_paa</span>, <span class="co">#(n_indices) 1: biomass 2: numbers</span></span>
<span>    agg_index_cv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_index_sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    index_Neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">index_Neff</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    fracyr_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">fracyr_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    use_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    use_index_paa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_index_paa</span><span class="op">)</span>,  <span class="co">#(n_years x n_indices)</span></span>
<span>    index_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">index_paa</span>,  <span class="co">#(n_indices x n_years x n_ages)</span></span>
<span>    selblock_pointer_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">selblock_pointer_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    waa_pointer_indices <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_indices</span>, <span class="co">#(n_indices)</span></span>
<span>    index_regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_indices</span><span class="op">)</span><span class="op">)</span> <span class="co">#(n_indices)</span></span></code></pre></div>
<p>Other arguments to <code>prepare_wham_input</code> have elements that
deal with parameters of the model that may or may not be estimated and
may configure process errors. First, the <code>selectivity</code>
argument (see <code><a href="../reference/set_selectivity.html">?set_selectivity</a></code>):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"logistic"</span>,<span class="fl">6</span><span class="op">)</span>, n_selblocks <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    fix_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>,<span class="cn">NULL</span>,<span class="cn">NULL</span>,<span class="cn">NULL</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    initial_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">0.1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then the <code>M</code> argument (see <code><a href="../reference/set_M.html">?set_M</a></code>). Here we
are specifying the initial values to use for annual natural mortalty at
age (by stock and region), but, by default it will not be estimated:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MAA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">Mpars</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">ages</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">M_re</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span>,,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co">#(nstocks x n_regions x n_years x n_ages)</span></span>
<span><span class="va">M_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>initial_MAA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">MAA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">ages</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>F</code> argument (see <code><a href="../reference/set_F.html">?set_F</a></code>). Here we are
specifying the initial values to use for the annual fully-selected
fishing mortality parameters for each fleet:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#initial values for annual fully-selected fishing mortality</span></span>
<span><span class="va">F_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="va">catch_info</span><span class="op">$</span><span class="va">n_fleets</span><span class="op">)</span><span class="op">)</span> <span class="co">#(n_years x n_fleets)</span></span></code></pre></div>
<p>The <code>q</code> argument (see <code><a href="../reference/set_q.html">?set_q</a></code>). Here we are
specifying the initial values to use for the catchability of the
indices:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#initial values for fully-selected catchability</span></span>
<span><span class="va">q_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>initial_q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-6</span>, <span class="va">index_info</span><span class="op">$</span><span class="va">n_indices</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally the <code>NAA_re</code> argument (see <code><a href="../reference/set_NAA.html">?set_NAA</a></code>).
Here we are specifying the initial values to use for the parameters for
initial abundance at age:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NAA_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N1_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">log_N1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, we can either create the input using all information at
once:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#all at once </span></span>
<span><span class="va">input_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span></span>
<span>    basic_info <span class="op">=</span> <span class="va">basic_info</span>,</span>
<span>    selectivity <span class="op">=</span> <span class="va">sel_info</span>, </span>
<span>    catch_info <span class="op">=</span> <span class="va">catch_info</span>, </span>
<span>    index_info <span class="op">=</span> <span class="va">index_info</span>, </span>
<span>    NAA_re <span class="op">=</span> <span class="va">NAA_info</span>,</span>
<span>    M <span class="op">=</span> <span class="va">M_info</span>, </span>
<span>    F <span class="op">=</span> <span class="va">F_info</span>, </span>
<span>    catchability <span class="op">=</span> <span class="va">q_info</span><span class="op">)</span></span></code></pre></div>
<p>Or we can create the input sequentially:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#piece by piece</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span>basic_info <span class="op">=</span> <span class="va">basic_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_NAA.html">set_NAA</a></span><span class="op">(</span><span class="va">input_seq</span>, NAA_re <span class="op">=</span> <span class="va">NAA_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_M.html">set_M</a></span><span class="op">(</span><span class="va">input_seq</span>, M <span class="op">=</span> <span class="va">M_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_catch.html">set_catch</a></span><span class="op">(</span><span class="va">input_seq</span>, catch_info <span class="op">=</span> <span class="va">catch_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_F.html">set_F</a></span><span class="op">(</span><span class="va">input_seq</span>, F <span class="op">=</span> <span class="va">F_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_indices.html">set_indices</a></span><span class="op">(</span><span class="va">input_seq</span>, index_info <span class="op">=</span> <span class="va">index_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_q.html">set_q</a></span><span class="op">(</span><span class="va">input_seq</span>, catchability <span class="op">=</span> <span class="va">q_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_selectivity.html">set_selectivity</a></span><span class="op">(</span><span class="va">input_seq</span>, selectivity <span class="op">=</span> <span class="va">sel_info</span><span class="op">)</span></span></code></pre></div>
<p>The functions for each component of the input allow the user to
quickly change just one aspect of the model and leave everything else
the same.</p>
<p>And the traditional use of the ASAP object to make the input:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">asap3</span>, F <span class="op">=</span> <span class="va">F_in</span>, catchability <span class="op">=</span> <span class="va">q_in</span>, selectivity <span class="op">=</span> <span class="va">sel_info</span><span class="op">)</span> </span></code></pre></div>
<p>First, let’s create the wham models without fitting them so the
objective function is evaluated at the intial parameters. Note there are
no process errors/random effects specified in these inputs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compare </span></span>
<span><span class="va">nofit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_all</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nofit_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_seq</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nofit_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_asap</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Now evaluating the objective function (by default at the initial
values), shows that the log-likelihoods are the same for each of the
models from inputs created different ways:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(nofit_all<span class="sc">$</span><span class="fu">fn</span>(), nofit_seq<span class="sc">$</span><span class="fu">fn</span>(),nofit_asap<span class="sc">$</span><span class="fu">fn</span>()) <span class="co">#equal</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(nofit_asap<span class="sc">$</span>par<span class="sc">-</span>nofit_all<span class="sc">$</span>par), <span class="fu">sum</span>(nofit_asap<span class="sc">$</span>par<span class="sc">-</span>nofit_seq<span class="sc">$</span>par) <span class="co">#all equal</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 71159.48 71159.48 71159.48</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span></code></pre>
<p>Also if we fit the models, we see that the maximized log-likelhoods
are also identical:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_seq</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_all</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fit_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_asap</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_seq</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span>, <span class="va">fit_all</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span>, <span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">fit_all</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">fit_seq</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="co">#all equal</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1059.663 1059.663 1059.663</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="stocks-and-2-regions-no-movement">3. 2 stocks and 2 regions, no movement<a class="anchor" aria-label="anchor" href="#stocks-and-2-regions-no-movement"></a>
</h2>
<p>Read in the ASAP3 .dat files into R and create an input from it. WHAM
will by default specify each ASAP dat file to represent a different
stock in a separate region without movement:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff_stocks_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_asap3_dat.html">read_asap3_dat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path_to_examples</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"north.dat"</span>,<span class="st">"south.dat"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">selectivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"age-specific"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>, n_selblocks <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    fix_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>,<span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    initial_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">diff_stocks_asap</span>, selectivity <span class="op">=</span> <span class="va">selectivity</span><span class="op">)</span></span></code></pre></div>
<p>As for the single stock example, we will extract all of the elements
of the <code>input</code> needed to create a wham input object without
using to the <code>asap3</code> object in
<code>prepare_wham_input</code>.</p>
<p>The various list arguments to prepare_wham_input or model component
functions are filled out with 2 stock and 2 region structure:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basic_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_stocks <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>    n_regions <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>    <span class="va">region_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North_r"</span>, <span class="st">"South_r"</span><span class="op">)</span>,</span>
<span>    <span class="va">stock_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North_s"</span>, <span class="st">"South_s"</span><span class="op">)</span>,</span>
<span>    ages <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_ages</span>,</span>
<span>    n_seasons <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    n_fleets <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">n_fleets</span>,</span>
<span>    fracyr_SSB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">fracyr_SSB</span><span class="op">)</span>, <span class="co">#(n_years x n_stocks)</span></span>
<span>    maturity <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">mature</span>, <span class="co">#(n_stocks x n_years x n_ages)</span></span>
<span>    years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>,</span>
<span>    waa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa</span>, <span class="co">#(any no. x n_years x n_ages)</span></span>
<span>    waa_pointer_ssb <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_ssb</span>, <span class="co">#(n_stocks)</span></span>
<span>    spawn_regions <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="co">#(n_stocks)</span></span>
<span>    spawn_seasons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#(n_stocks)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">catch_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_fleets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch</span><span class="op">)</span>, <span class="co">#(n_fleets)</span></span>
<span>    agg_catch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    agg_catch_cv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_catch_sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    catch_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">catch_paa</span>, <span class="co">#(n_fleets x n_years x n_ages)</span></span>
<span>    use_catch_paa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_catch_paa</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets), 0: don't use, 1: use</span></span>
<span>    catch_Neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">catch_Neff</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    selblock_pointer_fleets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">selblock_pointer_fleets</span><span class="op">)</span>, <span class="co">#(n_years x n_fleets)</span></span>
<span>    waa_pointer_fleets <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_fleets</span>, <span class="co">#(n_fleets)</span></span>
<span>    fleet_regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#(n_fleets)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">index_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NCOL</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_indices</span><span class="op">)</span>,</span>
<span>    agg_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    units_indices <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">units_indices</span>, <span class="co">#(n_indices) 1: biomass 2: numbers</span></span>
<span>    units_index_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">units_index_paa</span>, <span class="co">#(n_indices) 1: biomass 2: numbers</span></span>
<span>    agg_index_cv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">agg_index_sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    index_Neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">index_Neff</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    fracyr_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">fracyr_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    use_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    use_index_paa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">use_index_paa</span><span class="op">)</span>,  <span class="co">#(n_years x n_indices)</span></span>
<span>    index_paa <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">index_paa</span>,  <span class="co">#(n_indices x n_years x n_ages)</span></span>
<span>    selblock_pointer_indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">selblock_pointer_indices</span><span class="op">)</span>, <span class="co">#(n_years x n_indices)</span></span>
<span>    waa_pointer_indices <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">waa_pointer_indices</span>, <span class="co">#(n_indices)</span></span>
<span>    index_regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#(n_indices)</span></span>
<span></span>
<span><span class="co">#initial values for natural mortality, will not be estimated</span></span>
<span><span class="va">MAA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">M_re</span><span class="op">)</span> <span class="co">#(nstocks x n_regions x n_years x n_ages)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="va">MAA</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">MAA</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,,<span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">Mpars</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">ages</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>initial_MAA <span class="op">=</span> <span class="va">MAA</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#initial values for annual fully-selected fishing mortality</span></span>
<span><span class="va">F_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">basic_info</span><span class="op">$</span><span class="va">years</span><span class="op">)</span>, <span class="va">catch_info</span><span class="op">$</span><span class="va">n_fleets</span><span class="op">)</span><span class="op">)</span> <span class="co">#(n_years x n_fleets)</span></span>
<span></span>
<span><span class="co">#initial values for fully-selected catchability</span></span>
<span><span class="va">q_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>initial_q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-6</span>, <span class="va">index_info</span><span class="op">$</span><span class="va">n_indices</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#recruitment and "survival" random effects, initial N configuration is equilibrium (estimate initial recruitment and equilibrium fully-selected F), and inital median recruitment parameters</span></span>
<span><span class="va">NAA_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="st">"rec+1"</span>, N1_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"equilibrium"</span>,<span class="fl">2</span><span class="op">)</span>, recruit_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then create the inputs 3 different ways as above:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#all at once </span></span>
<span><span class="va">input_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span></span>
<span>    basic_info <span class="op">=</span> <span class="va">basic_info</span>,</span>
<span>    NAA_re <span class="op">=</span> <span class="va">NAA_list</span>,</span>
<span>    selectivity <span class="op">=</span> <span class="va">selectivity</span>, </span>
<span>    catch_info <span class="op">=</span> <span class="va">catch_info</span>, </span>
<span>    index_info <span class="op">=</span> <span class="va">index_info</span>, </span>
<span>    M <span class="op">=</span> <span class="va">M_info</span>, </span>
<span>    F <span class="op">=</span> <span class="va">F_info</span>, </span>
<span>    catchability <span class="op">=</span> <span class="va">q_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#piece by piece</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span>basic_info <span class="op">=</span> <span class="va">basic_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_NAA.html">set_NAA</a></span><span class="op">(</span><span class="va">input_seq</span>, NAA_re <span class="op">=</span> <span class="va">NAA_list</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_M.html">set_M</a></span><span class="op">(</span><span class="va">input_seq</span>, M <span class="op">=</span> <span class="va">M_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_catch.html">set_catch</a></span><span class="op">(</span><span class="va">input_seq</span>, catch_info <span class="op">=</span> <span class="va">catch_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_F.html">set_F</a></span><span class="op">(</span><span class="va">input_seq</span>, <span class="va">F_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_indices.html">set_indices</a></span><span class="op">(</span><span class="va">input_seq</span>, index_info <span class="op">=</span> <span class="va">index_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_q.html">set_q</a></span><span class="op">(</span><span class="va">input_seq</span>, <span class="va">q_info</span><span class="op">)</span></span>
<span><span class="va">input_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_selectivity.html">set_selectivity</a></span><span class="op">(</span><span class="va">input_seq</span>, selectivity <span class="op">=</span> <span class="va">selectivity</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_wham_input.html">prepare_wham_input</a></span><span class="op">(</span><span class="va">diff_stocks_asap</span>, selectivity <span class="op">=</span> <span class="va">selectivity</span>, NAA_re <span class="op">=</span> <span class="va">NAA_list</span><span class="op">)</span></span></code></pre></div>
<p>And the unfit models are equivalent:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#compare </span></span>
<span><span class="va">nofit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_all</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nofit_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_seq</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nofit_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_asap</span>, do.fit <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nofit_all</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="op">)</span>, <span class="va">nofit_seq</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="op">)</span>,<span class="va">nofit_asap</span><span class="op">$</span><span class="fu">fn</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">#equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nofit_asap</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">nofit_all</span><span class="op">$</span><span class="va">par</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nofit_asap</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">nofit_seq</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="co">#all equal</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 82326.74 82326.74 82326.74</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span></code></pre>
<p>As are the fitted models:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_seq</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_all</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fit_asap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_wham.html">fit_wham</a></span><span class="op">(</span><span class="va">input_asap</span>, do.retro <span class="op">=</span> <span class="cn">FALSE</span>, do.osa <span class="op">=</span> <span class="cn">FALSE</span>, do.sdrep <span class="op">=</span> <span class="cn">FALSE</span>, do.brps <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_seq</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span>, <span class="va">fit_all</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span>, <span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">obj</span><span class="op">)</span> <span class="co"># equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">fit_all</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fit_asap</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">-</span><span class="va">fit_seq</span><span class="op">$</span><span class="va">opt</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="co">#all equal</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 3000.941 3000.941 3000.941</span></span>
<span><span class="co">#&gt; [1] 0 0</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tim Miller, Brian Stock.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
